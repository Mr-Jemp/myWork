    <link href="/public/part/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/study/css/sharePlan.css" rel="stylesheet" type="text/css">
    <link href="/public/part/bootstrap/font-awesome/font-awesome.min.css" rel="stylesheet" type="text/css">
<!-- 头部 -->
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 sharePlanIndex_header">
            <i class="icon-chevron-left" onclick="javascript:history.go(-1);"></i>
            <!--<i class="icon-chevron-left" onclick="javascript: history.back(-1)"></i>-->
            教案分享
            <i class="icon-plus" onclick="javascript: location.href='#!/UploadSharePlan';"></i>
            <!--<i class="icon-upload-alt" onclick="javascript: location.href='/index.php?m=Teacher&c=Resource&a=UploadSharePlan';"></i>-->
        </div>
    </div>
</div>

<!-- 搜索框 -->
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 searchBox">
            <div class="input-group">
                <input id="keyword" type="text" class="form-control" placeholder="搜索的内容">
                <select class="hide" id="select_type" style="height:34px;">
                    <option value="1">自己</option>
                    <option value="2">其他</option>
                </select>
                <span class="input-group-btn">
                    <button class="btn btn-default search_btn" type="button">
                        <span class="icon-search" style="color: #A1A1A1"></span>
                    </button>
                </span>
            </div>
        </div>
    </div>
</div>

<!-- 选项卡 -->
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 tabBox">
            <ui>
                <li class="active" data-flag="myPlan_container">我的教案(2)</li>
                <li data-flag="otherPlan_container">其他教案</li>
                <li data-flag="myCollectPlan_container">我的收藏</li>
            </ui>
        </div>
    </div>
</div>

<!-- 内容区 -->
<!-- 我的教案 -->
<div class="container-fluid" id="myPlan_container">
    <div class="row" id="content"><div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="/index.php?m=Teacher&amp;c=Resource&amp;a=ShowSharePlan&amp;id=868"> <img src="/study/img/SharePlan/js_3ji_jiaoan2.jpg"> <h4>测试456</h4> <p></p> <p>上传时间: <span>2016-11-11</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="测试456.docx" href="../Public/Uploads/TeachingPlan/2016-11-11/5825296b611c2.pdf"> <i class="icon-download-alt"></i> 下载 </a> <a target="_blank" class="btn btn-link edit-click" id="ed868" href="/index.php?m=Teacher&amp;c=Resource&amp;a=EditSharePlan&amp;id=868"> <i class="icon-edit"></i> 编辑 </a><button type="button" class="btn btn-link is_public" data-type="已公开" id="868"> <i class="icon-unlock"></i> 已公开 </button><button type="button" class="btn btn-link delete-click" id="dp868"> <i class="icon-trash"></i> 删除 </button></div> </div> </div><div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="/index.php?m=Teacher&amp;c=Resource&amp;a=ShowSharePlan&amp;id=867"> <img src="/study/img/SharePlan/js_3ji_jiaoan2.jpg"> <h4>测试132</h4> <p></p> <p>上传时间: <span>2016-11-11</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="测试132.docx" href="../Public/Uploads/TeachingPlan/2016-11-11/5825290f55161.pdf"> <i class="icon-download-alt"></i> 下载 </a> <a target="_blank" class="btn btn-link edit-click" id="ed867" href="/index.php?m=Teacher&amp;c=Resource&amp;a=EditSharePlan&amp;id=867"> <i class="icon-edit"></i> 编辑 </a><button type="button" class="btn btn-link is_public" data-type="公开" id="867"> <i class="icon-lock"></i> 公开 </button><button type="button" class="btn btn-link delete-click" id="dp867"> <i class="icon-trash"></i> 删除 </button></div> </div> </div></div>
    <div class="row">
        <div class="col-xs-12">
            <nav><ul class="pagination pagination-sm" id="myCreate"></ul></nav>
        </div>
    </div>
</div>

<!-- 其他教案 -->
<div class="container-fluid" style="display: none" id="otherPlan_container">
    <div class="row" id="other_create">
    </div>
    <div class="row">
        <div class="col-xs-12">
            <nav><ul class="pagination pagination-sm" id="otColl"></ul></nav>
        </div>
    </div>
</div>

<!-- 我的收藏 -->
<div class="container-fluid" style="display: none" id="myCollectPlan_container">
    <div class="row" id="my_collect">
    </div>
    <div class="row">
        <div class="col-xs-12">
            <nav><ul class="pagination pagination-sm" id="myColl"></ul></nav>
        </div>
    </div>
</div>

<!-- 查看更多 -->
<div class="container-fluid" id="see_more_search_container" style="display: none">
    <div class="row">
        <div class="col-xs-12">
            <button type="button" class="btn btn-default btn-block see_more_search">查看更多»</button>
        </div>
    </div>
</div>

<!-- 底部工具条 -->


<!-- <script type="text/javascript" src="/Public/jQuery/jquery.min.js"></script> -->
<script src="/study/js/jqPaginator.js"></script>
<script type="text/javascript">
    $(function () {
        /* tab 切换 */
        $(".tabBox li").on("click", function () {
            var oldActiveObj = $(this).siblings(".active");
            var oldContainerId = oldActiveObj.attr("data-flag");
            oldActiveObj.removeClass("active");
            $("#" + oldContainerId).hide();
            var newContainerId = $(this).attr("data-flag");
            $(this).addClass("active");
            $("#" + newContainerId).show();
        });

        /* 分页组件 */
        var my_num='2';
        var my_coll='0';
        var other_num='0';
        $.jqPaginator('#myCreate', {
            totalPages:parseInt( Math.ceil(my_num==0?1:my_num/ 6)),
            visiblePages: 7,
            currentPage: 1,
            first: '<li><a href="javascript:;">首页</a></li>',
            prev: '<li><a href="javascript:;">上一页</a></li>',
            next: '<li><a href="javascript:;">下一页</a></li>',
            last: '<li><a href="javascript:;">末页</a></li>',
            page: '<li><a href="javascript:;">{{page}}</a></li>',
            onPageChange: function (num,type) {
                $.post("/index.php?m=Teacher&c=Resource&a=SharePlan",{p:num,type:'my_page'},function(data){
                    var inner="";
                    for(var i=0;i<data.length;i++){
                        var image=data[i].image;
                        var title=data[i].title;
                        var describe=data[i].describe;
                        var create_time=data[i].create_time;
                        var state=data[i].state;
                        var id=data[i].id;
                        var src=data[i].src;
                        var download=data[i].download;
                        var change_str="";
                        var state_str="";
                        var delete_str='';
                        var collection_str='';
                        delete_str='<button type="button" class="btn btn-link delete-click" id="dp'+id+'"> <i class="icon-trash"></i> 删除 </button>';
                        change_str='<a target="_blank" class="btn btn-link edit-click" id="ed'+id+'" href="/index.php?m=Teacher&c=Resource&a=EditSharePlan&id='+id+'"> <i class="icon-edit"></i> 编辑 </a>';
                        if(state==1){
                            state_str='<button type="button" class="btn btn-link is_public" data-type="已公开" id="'+id+'"> <i class="icon-unlock"></i> 已公开 </button>';
                        }else{
                            state_str='<button type="button" class="btn btn-link is_public" data-type="公开" id="'+id+'"> <i class="icon-lock"></i> 公开 </button>';
                        }

                        inner += '<div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="'+'/index.php?m=Teacher&c=Resource&a=ShowSharePlan&id='+id+'"> <img src='+image+'"/Public"> <h4>'+title+'</h4> <p>'+describe+'</p> <p>上传时间: <span>'+create_time+'</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="'+download+'" href='+src+'"../Public"> <i class="icon-download-alt"></i> 下载 </a> '+change_str+state_str+delete_str+'</div> </div> </div>';
                    }
                    $('#content').html(inner);
                },'json');
            }
        });

        $.jqPaginator('#otColl', {
            totalPages:parseInt( Math.ceil(other_num==0?1:other_num/ 6)),
            visiblePages: 7,
            currentPage: 1,
            first: '<li><a href="javascript:;">首页</a></li>',
            prev: '<li><a href="javascript:;">上一页</a></li>',
            next: '<li><a href="javascript:;">下一页</a></li>',
            last: '<li><a href="javascript:;">末页</a></li>',
            page: '<li><a href="javascript:;">{{page}}</a></li>',
            onPageChange: function (num, type) {
                $.post("/index.php?m=Teacher&c=Resource&a=SharePlan",{p:num,type:'ot_page'},function(data){
                    var inner="";
                    for(var i=0;i<data.length;i++){
                        var image=data[i].image;
                        var title=data[i].title;
                        var describe=data[i].describe;
                        var create_time=data[i].create_time;
                        var id=data[i].id;
                        var src=data[i].src;
                        var change_str="";
                        var state_str="";
                        var delete_str='';
                        var source_src=data[i].source_src;
                        var is_collect=data[i].is_collect;
                        var collect_id=data[i].collect_id;
                        var download=data[i].download;
                        delete_str='<button type="button" class="btn btn-link delete-click" id="dp'+id+'"> <i class="icon-trash"></i> 删除 </button>';
                        change_str='<a target="_blank" class="btn btn-link edit-click" id="ed'+id+'" href="/index.php?m=Teacher&c=Resource&a=EditSharePlan&id='+id+'"> <i class="icon-edit"></i> 编辑 </a>';
                        if(is_collect==1){
                            state_str='<button type="button" class="btn btn-link collection-click" id="collect'+collect_id+'"> <i class="icon-star-empty"></i> 已收藏 </button>';
                        }else{
                            state_str='<button type="button" class="btn btn-link collection-click" id="collect'+id+'"> <i class="icon-star"></i> 收藏 </button>';
                        }

                        inner +='<div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="'+'/index.php?m=Teacher&c=Resource&a=ShowSharePlan&id='+id+'"> <img src='+image+'"/Public"> <h4>'+title+'</h4> <p>'+describe+'</p> <p>上传时间: <span>'+create_time+'</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="'+download+'" href='+source_src+'"../Public"> <i class="icon-download-alt"></i> 下载 </a> '+state_str+'</div> </div> </div>';
                    }
                    $('#other_create').html(inner);
                },'json');
            }
        });

        $.jqPaginator('#myColl', {
            totalPages:parseInt( Math.ceil(my_coll==0?1:my_coll/ 6)),
            visiblePages: 7,
            currentPage: 1,
            first: '<li><a href="javascript:;">首页</a></li>',
            prev: '<li><a href="javascript:;">上一页</a></li>',
            next: '<li><a href="javascript:;">下一页</a></li>',
            last: '<li><a href="javascript:;">末页</a></li>',
            page: '<li><a href="javascript:;">{{page}}</a></li>',
            onPageChange: function (num, type) {
                $.post("/index.php?m=Teacher&c=Resource&a=SharePlan",{p:num,type:'cl_page'},function(data){
                    var inner="";
                    for(var i=0;i<data.length;i++){
                        var image=data[i].image;
                        var title=data[i].title;
                        var describe=data[i].describe;
                        var create_time=data[i].create_time;
                        var id=data[i].id;
                        var src=data[i].src;
                        var file_id=data[i].file_id;
                        var collection_id=data[i].collection_id;
                        var source_src=data[i].source_src;
                        var download=data[i].download;

                        inner +='<div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="'+'/index.php?m=Teacher&c=Resource&a=ShowSharePlan&id='+file_id+'"> <img src='+image+'"/Public"> <h4>'+title+'</h4> <p>'+describe+'</p> <p>上传时间: <span>'+create_time+'</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="'+download+'" href='+source_src+'"../Public"> <i class="icon-download-alt"></i> 下载 </a> <button type="button" class="btn btn-link collection_cancel" id="collect'+collection_id+'"> <i class="icon-star-empty"></i> 取消收藏 </button> </div> </div> </div>';
                    }
                    $('#my_collect').html(inner);
                },'json');
            }
        });
    });
</script>
<script type="text/javascript">
    var V = function() {};
    /*公开还是私有*/
    $(function(){
        var search_word="";
        var is_search="";
        var p=2;
        var m=0;
        $('body').delegate('.is_public','click',function(){
            var _this=$(this);
            var id=_this.attr('id');
            var text=_this.attr('data-type');
            if(text=="公开"){
                if(confirm("是否公开? ")){
                    $.ajax({
                        type:'get',
                        url:"/index.php?m=Teacher&c=Resource&a=isPublic&id="+id+"&type="+text,
                        dataType:'json',
                        success:function(data){
                            if(data==1){
                                _this.html('<i class="icon-unlock"></i> 已公开');
                                _this.attr("data-type", "已公开");
                            }
                        }
                    })
                }
            }else{
                if(confirm("是否私有? ")){
                    $.ajax({
                        type:'get',
                        url:"/index.php?m=Teacher&c=Resource&a=isPublic&id="+id+"&type="+text,
                        dataType:'json',
                        success:function(data){
                            if(data==1){
                                _this.html('<i class="icon-lock"></i> 公开');
                                _this.attr("data-type", "公开");
                            }
                        }
                    })
                }
            }
        });
        /*删除收藏*/
        $('body').delegate('.btn.delete-click','click',function(){
            if (confirm("是否删除?")) {} else {
                return;
            }
            var _this=$(this);
            var share_plan_id = $(this).attr('id').substring(2);
            var data = new V();
            var cc = $(this);
            data.share_plan_id = share_plan_id;
            $.ajax({
                type: 'GET',
                data: data,
                url: "/index.php?m=Teacher&c=Resource&a=DelSharePlan",
                dataType: "json",
                success: function(data) {
                    if (data.error == 0) {
                        _this.parents('.contentBox').fadeOut();
                        alert("删除成功");
                    } else {
                        alert("删除失败");
                    }
                },
                error: function(e, xhl, dd) {
                    alert("未知错误,删除失败");
                }
            });
        });
        $('body').delegate('.btn.collection-click','click',function(){
            var share_plan_id = $(this).attr('id').replace('collect','');
            var data = new V();
            var _this = $(this);
            console.log(share_plan_id);
            data.share_plan_id = share_plan_id;
            if(confirm("是否收藏？")){
                $.ajax({
                    type: 'GET',
                    data: data,
                    url: "/index.php?m=Teacher&c=Resource&a=CollectionSharePlan",
                    dataType: "json",
                    success: function(data) {
                        if (data.error == 0) {
                            alert("收藏成功");
                            _this.html('<i class="icon-star-empty"></i> 已收藏');
                        } else if (data.error == 2) {
                            alert("已经收藏过了");
                        } else {
                            alert("收藏失败");
                        }
                    },
                    error: function(e, xhl, dd) {
                        alert("未知错误,收藏失败");
                    }
                });
            }
        });
        $('body').delegate('.btn.delete_collect','click',function(){
            var id=$(this).attr('id');
            var _this=$(this);
            if(confirm("是否删除?")){
                $.ajax({
                    type:'GET',
                    url:"/index.php?m=Teacher&c=Resource&a=delCollection&id="+id,
                    dataType:"json",
                    success:function(data){
                        _this.parents('contentBox').fadeOut();
                        alert("删除成功！")
                    }
                })
            }

        });

        /*取消收藏*/
        $('body').delegate(".btn.collection_cancel",'click',function(){
            var id=$(this).attr('id').replace('collect','');
            var _this=$(this);
            if(confirm('是否取消收藏？')){
                $.post("/index.php?m=Teacher&c=Resource&a=delCollection",{id:id},function(data){
                    if(data==1){
                        alert('取消成功！');
                        _this.parents('.contentBox').fadeOut();
                    }

                },'json')
            }
        });
        $('body').delegate(".btn.ot_collection_cancel",'click',function(){
            var id=$(this).attr('id').replace('collect','');
            var _this=$(this);
            var text=_this.text();
            if(text=="已收藏"){
                if(confirm('是否取消收藏？')){
                    $.post("/index.php?m=Teacher&c=Resource&a=DeleteCollection",{id:id},function(data){
                        if(data!=0){
                            alert('取消成功！')
                            _this.text('收藏')
                        }

                    },'json')
                }
            }else{
                if(confirm('是否收藏？')){
                    $.post("/index.php?m=Teacher&c=Resource&a=CollectionSharePlan",{id:id,type:"ot"},function(data){
                        if(data!=0){
                            alert('收藏成功！');
                            _this.text('已收藏')
                        }

                    },'json')
                }
            }
        });
        /*查看更多*/

        var my_page=2;
        var ot_page=2;
        var cl_page=2;

        /*搜索教案*/
        var search_word="";
        var is_search="";
        var p=2;
        $('.search_btn').click(function(){
            $("#myPlan_container,#otherPlan_container,#myCollectPlan_container").hide();
            $(".tabBox li").removeClass("active");

            var search_text=$('#keyword').val();
            var url='';
            url="/index.php?m=Teacher&c=Resource&a=searchPlan&search_text="+search_text;
            is_search=1;
            $.ajax({
                type:'get',
                url:url,
                dataType:'json',
                success:function(data){
                    var inner="";
                    for(var i=0;i<data.length;i++){
                        var image=data[i].image;
                        var title=data[i].title;
                        var describe=data[i].describe;
                        var create_time=data[i].create_time;
                        var state=data[i].state;
                        var id=data[i].id;
                        var src=data[i].src;
                        var collection_id=data[i].collection_id;
                        var change_str="";
                        var state_str="";
                        var delete_str='';
                        var collection_str='';
                        var download=data[i].download;

                        inner += '<div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="'+'/index.php?m=Teacher&c=Resource&a=ShowSharePlan&id='+id+'"> <img src='+image+'"/Public"> <h4>'+title+'</h4> <p>'+describe+'</p> <p>上传时间: <span>'+create_time+'</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="'+download+'" href='+src+'"../Public"> <i class="icon-download-alt"></i> 下载 </a> '+change_str+state_str+collection_str+'</div> </div> </div>';
                    }
                    $('#content').html(inner);
                    $("#myCreate").empty();
                    $("#myPlan_container").show();
                    $("#see_more_search_container").show();
                }
            });
            search_word=search_text;
            p=2;
        });
        $('body').delegate('.btn.see_more_search','click',function(){
            $.post("/index.php?m=Teacher&c=Resource&a=searchPlan",{search_text:search_word,p:p},function(data){
                var inner="";
                for(var i=0;i<data.length;i++){
                    var image=data[i].image;
                    var title=data[i].title;
                    var describe=data[i].describe;
                    var create_time=data[i].create_time;
                    var id=data[i].id;
                    var src=data[i].src;
                    var change_str="";
                    var state_str="";
                    var delete_str='';
                    var collection_str='';
                    var download=data[i].download;
                    inner += '<div class="col-xs-12 contentBox"> <a target="_blank" class="contentBody" href="'+'/index.php?m=Teacher&c=Resource&a=ShowSharePlan&id='+id+'"> <img src='+image+'"/Public"> <h4>'+title+'</h4> <p>'+describe+'</p> <p>上传时间: <span>'+create_time+'</span></p> </a> <div class="contentFooter"> <div class="contentFooterBody"> <a class="btn btn-link" download="'+download+'" href='+src+'"../Public"> <i class="icon-download-alt"></i> 下载 </a> '+change_str+state_str+collection_str+'</div> </div> </div>';
                }
                $('#content').append(inner);
            },'json');
            p++;
        });

    });
</script>